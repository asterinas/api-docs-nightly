<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Gets a file from a file descriptor as fast as possible."><title>get_file_fast in aster_kernel::fs::file_table - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="aster_kernel" data-themes="" data-resource-suffix="" data-rustdoc-version="1.94.0-nightly (1aa9bab4e 2025-12-05)" data-channel="nightly" data-search-js="search-9e2438ea.js" data-stringdex-js="stringdex-a3946164.js" data-settings-js="settings-c38705f0.js" ><script src="../../../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-a410ff4d.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc macro"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">get_file_fast</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../aster_kernel/index.html">aster_<wbr>kernel</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><div id="rustdoc-modnav"><h2><a href="index.html">In aster_<wbr>kernel::<wbr>fs::<wbr>file_<wbr>table</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">aster_kernel</a>::<wbr><a href="../index.html">fs</a>::<wbr><a href="index.html">file_table</a></div><h1>Macro <span class="macro">get_<wbr>file_<wbr>fast</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/aster_kernel/fs/file_table.rs.html#177-199">Source</a> </span></div><pre class="rust item-decl"><code>macro_rules! get_file_fast {
    ($file_table:expr, $file_desc:expr) =&gt; { ... };
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Gets a file from a file descriptor as fast as possible.</p>
<p><code>file_table</code> should be a mutable borrow of the file table contained in the <code>file_table</code> field
(which is a <a href="core::cell::RefCell"><code>RefCell</code></a>) in <a href="../../process/posix_thread/thread_local/struct.ThreadLocal.html" title="struct aster_kernel::process::posix_thread::thread_local::ThreadLocal"><code>ThreadLocal</code></a>. A mutable borrow is required because its
exclusivity can be useful for achieving lockless file lookups.</p>
<p>If the file table is not shared with another thread, this macro will be free of locks
(<a href="../../../ostd/sync/rwarc/struct.RwArc.html#method.read" title="method ostd::sync::rwarc::RwArc::read"><code>RwArc::read</code></a>) and free of reference counting (<a href="../../prelude/struct.Arc.html#method.clone" title="method aster_kernel::prelude::Arc::clone"><code>Arc::clone</code></a>).</p>
<p>If the file table is shared, the read lock is taken, the file is cloned, and then the read lock
is released. Cloning and releasing the lock is necessary because we cannot hold such locks when
operating on files, since many operations on files can block.</p>
<p>Note: This has to be a macro due to a limitation in the Rust borrow check implementation. Once
<a href="https://github.com/rust-lang/rust/issues/58910">https://github.com/rust-lang/rust/issues/58910</a> is fixed, we can try to convert this macro to
a function.</p>
</div></details></section></div></main></body></html>